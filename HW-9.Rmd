---
title: "HW 9"
author: "Hannah Lim"
date: "2025-04-22"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(mosaic)
library(tidyverse)
library(kableExtra)
library(effectsize)

boards = read.csv('solder.csv')
groceries = read.csv('groceries.csv')
```

## UT EID:
hl33387

## GitHub Link:


## Problem 1: Manufacturing Flaws in Circuit Boards

Part A: Make two plots. The first plot should provide evidence that the size of the opening on the solder gun is related to the number of skips. The second should provide evidence that the thickness of the alloy used for soldering is related to the number of skips. Give each plot an informative caption describing what is shown in the plot.

Part B: Build a regression model with skips as the outcome and with the following terms as predictors:
• a main effect for Opening
• a main effect for Solder type
• an interaction between Opening and Solder type
Make a table that shows the estimate and 95% large-sample confidence interval for each coefficient in your model.1

Part C: Interpret each estimated coefficient in your model in no more than 1-2 sentences. A good template here is provided in the course packet, when we fit a model for the video games data that had an interaction in it and interpreted each coefficient in a sentence or two.

The baseline skips for boards with large openings and a thick solder is 0. The main effect for the opening medium size variable is 2, while the opening small size variable is 5. These are the effect of OpeningM and OpeningS in isolation respectively. The main effect for the Solder variable is 68 skips, and it is the effect of solder in isolation. The interaction effect for OpeningM and SolderThin is -1 skips. This means that boards that have both medium sized openings and a thin solder yield average skips that is one less than what is expected from summing the individual "isolated" effectings of the two variables. The effect of OpeningS and SolderThin, which was 10 skips, shows that in boards that have small sized openings and a thin solder will yield average skips that is 10 skips more than what is expected for the isolated effects of the variables.

Part D: If you had to recommend a combination of Opening size and Solder thickness to AT&T based on this analysis, which one would it be, and why? (Remember, the goal is to minimize the number of skips in the manufacturing process.)

If I had to recommend a combination of Opening size and Solder thickness to AT&T based on this analysis, it would be the large opening and the thick solder. This is because the predicted skips is 0. As the opening gets smaller, the skips increase, as it does with a thin solder as well.

```{r}
# Part A:
ggplot(boards) + 
  geom_boxplot(aes(x=Opening, y=skips)) +
  labs( x = "Opening Size", 
        y = "Number of Skips", 
        caption = "The median for number of skips for each opening size increases as the opening size decreases.\n The median number of skips for the large opening is 0 while the median for the small opening is 8 skips.\n The range for the number of skips for the small opening is bigger than the large opening and the max skips collected is 48 skips.\n This shows that the opening size influences the number of skips.", 
        title = "Size of the Opening vs. Number of Skips")

ggplot(boards) + 
  geom_boxplot(aes(x=Solder, y=skips)) +
  labs( x = "Solder Thickness", 
        y = "Number of Skips",
        caption = "The median for the number of skips for the thin solder is higher than it is for the thick solder.\n The range is also bigger for the this solder, the max number of skips being 48 skips.\n This shows that the thickness of the solder influences the number of skips.",
        title = "Solder Thickness vs. Number of Skips")

# Part B:
model_boards <- lm(skips ~ Opening + Solder + Opening:Solder, data = boards)
coef(model_boards) %>%
  round(0)
```

## Problem 2: Grocery Store Prices

Part A. What kind of price differences do we see across the different stores? Make a bar graph with Store on the vertical axis and average price of products sold at that store on the horizontal axis. (Remember coord_flip.) Give your plot an informative caption. You’ll need to wrangle the data into an appropriate form first before you can make your plot.

```{r}
avg_price_by_store <- groceries %>%
  group_by(Store) %>%
  summarize(avg_price = mean(Price, na.rm = TRUE))

ggplot(avg_price_by_store, aes(x = avg_price, y = reorder(Store, avg_price))) +
  geom_bar(stat = "identity") +
  labs(
    x = "Average Price",
    y = "Store",
    title = "Average Product Prices by Store",
    caption = "Stores are sorted by average price. Whole Foods has the highest average price while Fiesta has the lowest."
    ) + 
  coord_flip() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
```

Part B. Your plot in Part A shows differences in average price across stores. But a big issue with this plot is that not all stores sell all products. Some products (eggs, milk) are sold in all stores. But others aren’t. For example, Walgreen’s wasn’t selling Greek yogurt in that store on that day; and you’re about as likely to find Lucky Charms at Wheatsville Co-op or Whole Foods as you are to find an actual leprechaun. Therefore, if you want to make an apples-to-apples comparison of prices, you can’t simply ask which grocery store charged the highest average price across all products. To illustrate this fact, please make a bar graph with Product on the vertical axis and number of stores selling that product on the horizontal axis. Give your bar graph an informative caption. Again, you’ll need to wrangle the data into an appropriate form first before you can make your plot. (For the purposes of this question, you can treat the two HEBs and two Whole Foods as separate stores, which makes the data wrangling easier. You’ll know you’ve gotten this right if your bar graph maxes out at 16 for eggs and milk.)

```{r}
products_by_store <- groceries %>%
  group_by(Product) %>%
  summarize(n_stores = n_distinct(Store))

ggplot(products_by_store, aes(x = n_stores, y = reorder(Product, n_stores))) +
  geom_bar(stat = "identity") +
  labs(
    x = "Number of Stores Selling Product",
    y = "Product",
    title = "Availability of Each Product Across Stores",
    caption = "Eggs and milk are sold in all 16 stores; other products vary."
  )
```

Part C. Now let’s use regression to try to isolate the effects of Type of store versus the actual products being sold. Fit a model for Price versus Product and the Type of store. Fill in the blanks: “Compared with ordinary grocery stores (like Albertsons, HEB, or Krogers), convenience stores charge somewhere between (lower bound) and (upper bound) dollars more for the same product.” Use a large-sample confidence interval here, and round your answer to two decimal places, i.e. the nearest penny.

```{r}
model_groceries <- lm(Price ~ Product + Type, data = groceries)
summary(model_groceries)
confint(model_groceries)
```

Part D. Now fit a model for Price versus Product and Store. Which two stores seem to charge the lowest prices when comparing the same product? Which two stores seem to charge the highest prices when comparing the same product

```{r}
model_store <- lm(Price ~ Product + Store, data = groceries)
summary(model_store)

coef(summary(model_store))
```

Part E. Central Market is owned by HEB but has a reputation as a fancier grocery store that charges premium prices. But is that because Central Market charges more for the same product? (This is referred to as price discrimination in the marketing world.) Or, on the other hand, is that because Central Market sells different products that are inherently more expensive than those sold at a typical HEB? Let’s use your model from Part D to try to disambiguate between two possibilities:
• Central Market charges more than HEB for the same product.
• Central Market charges a similar amount to HEB for the same product.
Inspect the coefficients from your fitted model. Which of these two possibilities looks right to you? Cite specific numerical evidence from your model. Try to put any difference between HEB and Central Market into the larger context: how big is the HEB/Central Market difference, compared to differences among other stores?

```{r}
coef(model_store)["StoreCentral Market"]
coef(model_store)["StoreH-E-B "]

range(coef(model_store)[grepl("Store", names(coef(model_store)))])
```

Part F. Finally let’s consider the Income variable. To facilitate interpretation, first use mutate to define an Income10K variable that measures income in multiples of $10,000 (e.g. 1 = $10,000, 2 = $20,000, and so on). Then fit a model for Price versus Product and Income10K and use your model to answer these two questions:
• Based on the sign of the Income10K coefficient, do consumers in poorer ZIP codes seem to pay more or less for the same product, on average? How do you know?
• How large is the estimated size of the effect of Income10K on Price? To answer this question: fill in the blank: “A one-standard deviation increase in the income of a ZIP code seems to be associated with a (blank) standard-deviation change in the price that consumers in that ZIP code expect to pay for
the same product.” Remember standardized coefficients from the textbook.

```{r}
income <- groceries %>%
  mutate(Income10K = Income / 10000)

model_income <- lm(Price ~ Product + Income10K, data = income)
summary(model_income)

standardize_parameters(model_income)
```
Positive coefficient, consumers in poorer ZIP codes seem to pay less for the same product on average. This means that for every $10,000 increase in income, the price goes up by $5.62, on average for the same product.
A one-standard deviation increase in the income of a ZIP code seems to be associated with a -0.03 standard-deviation change in the price that consumers in that ZIP code expect to pay for the same product.
 
## Problem 3:
